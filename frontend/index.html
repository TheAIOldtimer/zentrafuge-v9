<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zentrafuge v9 - Your AI Companion</title>
    
    <!-- Favicon and app icons -->
    <link rel="icon" type="image/png" href="assets/Zentrafuge-WIDE-Logo-Transparent.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- SEO and social -->
    <meta name="description" content="Zentrafuge v9 - Memory-first, emotionally intelligent AI companion that learns and grows with you.">
    <meta name="keywords" content="AI companion, emotional intelligence, memory, chat, assistant">
    <meta property="og:title" content="Zentrafuge v9 - Your AI Companion">
    <meta property="og:description" content="Experience genuine AI companionship with memory, emotions, and growth.">
    <meta property="og:image" content="assets/Zentrafuge-WIDE-Logo-Transparent.png">
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Firebase SDK -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-auth-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-firestore-compat.min.js"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <img src="assets/Zentrafuge-WIDE-Logo-Transparent.png" alt="Zentrafuge" class="loading-logo">
            <div class="loading-spinner"></div>
            <p class="loading-text">Initializing Zentrafuge v9...</p>
        </div>
    </div>

    <!-- Authentication Screen -->
    <div id="auth-screen" class="screen" style="display: none;">
        <div class="auth-container">
            <div class="auth-header">
                <img src="assets/Zentrafuge-WIDE-Logo-Transparent.png" alt="Zentrafuge" class="auth-logo">
                <h1>Welcome to Zentrafuge v9</h1>
                <p class="auth-subtitle">Your memory-first, emotionally intelligent AI companion</p>
            </div>

            <!-- Login Form -->
            <div id="login-form" class="auth-form">
                <h2>Sign In</h2>
                <form id="login-form-element">
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Sign In</button>
                </form>
                <p class="auth-switch">
                    Don't have an account? 
                    <a href="register.html" id="show-register">Create one</a>
                </p>
            </div>

            <!-- Register Form -->
            <div id="register-form" class="auth-form" style="display: none;">
                <h2>Create Account</h2>
                <form id="register-form-element">
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Password</label>
                        <input type="password" id="register-password" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label for="register-confirm">Confirm Password</label>
                        <input type="password" id="register-confirm" required minlength="6">
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="terms-accept" required>
                            I agree to the <a href="terms.html" target="_blank">Terms of Service</a>
                        </label>
                    </div>
                    <button type="submit" class="btn btn-primary">Create Account</button>
                </form>
                <p class="auth-switch">
                    Already have an account? 
                    <a href="#" id="show-login">Sign in</a>
                </p>
            </div>

            <div id="auth-error" class="error-message" style="display: none;"></div>
        </div>
    </div>

    <!-- Onboarding Screen -->
    <div id="onboarding-screen" class="screen" style="display: none;">
        <div class="onboarding-container">
            <div class="onboarding-header">
                <h1>Let's Get You Set Up</h1>
                <p>Help us personalize your Zentrafuge experience</p>
                <div class="progress-indicator">
                    <div class="progress-dot active" data-step="0"></div>
                    <div class="progress-dot" data-step="1"></div>
                    <div class="progress-dot" data-step="2"></div>
                    <div class="progress-dot" data-step="3"></div>
                    <div class="progress-dot" data-step="4"></div>
                </div>
            </div>

            <!-- Step 0: Welcome -->
            <div id="onboarding-step-0" class="onboarding-step">
                <h2>Welcome to Zentrafuge v9! üß†</h2>
                <div class="cael-intro">Hello! I'm Cael, your emotional companion.</div>
                <p>I'm different from other AI assistants because:</p>
                <ul class="feature-list">
                    <li>üíô I remember our conversations and build genuine relationships</li>
                    <li>üß† I learn your communication style and emotional needs</li>
                    <li>üîí Your data stays encrypted and belongs to you</li>
                    <li>üå± I grow and evolve with each interaction</li>
                </ul>
                <div class="navigation-buttons">
                    <div></div>
                    <button class="btn btn-primary" onclick="nextOnboardingStep()">Let's Begin</button>
                </div>
            </div>

            <!-- Step 1: Communication & Safety -->
            <div id="onboarding-step-1" class="onboarding-step" style="display: none;">
                <div class="theme-header">How You Like to Be Heard</div>
                <div class="question-section">
                    <label class="question-label">How do you prefer to receive feedback?</label>
                    <div class="question-context">This helps me understand your communication style.</div>
                    <div class="multi-choice">
                        <div class="multi-choice-item">
                            <input type="radio" id="heard-direct" name="communication_style" value="direct_feedback" />
                            <label for="heard-direct">Direct and honest feedback</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="radio" id="heard-gentle" name="communication_style" value="gentle_exploration" />
                            <label for="heard-gentle">Gentle exploration</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="radio" id="heard-witness" name="communication_style" value="just_witnessing" />
                            <label for="heard-witness">Just witnessing and presence</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="radio" id="heard-mix" name="communication_style" value="mix_depends" />
                            <label for="heard-mix">It depends on the situation</label>
                        </div>
                    </div>
                </div>
                <div class="question-section">
                    <label class="question-label">How do you prefer to process emotions?</label>
                    <div class="question-context">This helps me understand your emotional pacing.</div>
                    <div class="multi-choice">
                        <div class="multi-choice-item">
                            <input type="radio" id="process-deep" name="emotional_pacing" value="dive_deep_quickly" />
                            <label for="process-deep">Dive deep quickly</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="radio" id="process-gradual" name="emotional_pacing" value="circle_gradually" />
                            <label for="process-gradual">Circle around gradually</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="radio" id="process-varies" name="emotional_pacing" value="varies_situation" />
                            <label for="process-varies">It varies by situation</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="radio" id="process-unsure" name="emotional_pacing" value="not_sure_yet" />
                            <label for="process-unsure">Not sure yet</label>
                        </div>
                    </div>
                </div>
                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousOnboardingStep()">Back</button>
                    <button class="btn btn-primary" onclick="nextOnboardingStep()">Continue</button>
                </div>
            </div>

            <!-- Step 2: Identity & Meaning -->
            <div id="onboarding-step-2" class="onboarding-step" style="display: none;">
                <div class="theme-header">Understanding Your Journey</div>
                <div class="question-section">
                    <label class="question-label">What life chapter are you in right now?</label>
                    <div class="question-context">A few words about where you are in life.</div>
                    <input type="text" id="life_chapter" name="life_chapter" placeholder="e.g., rebuilding, exploring, transitioning..." />
                </div>
                <div class="question-section">
                    <label class="question-label">What gives your life meaning?</label>
                    <div class="question-context">Select all that resonate with you.</div>
                    <div class="multi-choice">
                        <div class="multi-choice-item">
                            <input type="checkbox" id="meaning-creative" name="sources_of_meaning" value="creative_work" />
                            <label for="meaning-creative">Creative work</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="checkbox" id="meaning-helping" name="sources_of_meaning" value="helping_others" />
                            <label for="meaning-helping">Helping others</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="checkbox" id="meaning-nature" name="sources_of_meaning" value="being_in_nature" />
                            <label for="meaning-nature">Being in nature</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="checkbox" id="meaning-learning" name="sources_of_meaning" value="learning_growing" />
                            <label for="meaning-learning">Learning and growing</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="checkbox" id="meaning-connection" name="sources_of_meaning" value="deep_connections" />
                            <label for="meaning-connection">Deep connections</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="checkbox" id="meaning-other" name="sources_of_meaning" value="something_else" />
                            <label for="meaning-other">Something else</label>
                        </div>
                    </div>
                </div>
                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousOnboardingStep()">Back</button>
                    <button class="btn btn-primary" onclick="nextOnboardingStep()">Continue</button>
                </div>
            </div>

            <!-- Step 3: Support Style -->
            <div id="onboarding-step-3" class="onboarding-step" style="display: none;">
                <div class="theme-header">How I Can Best Support You</div>
                <div class="question-section">
                    <label class="question-label">What kind of support helps you most?</label>
                    <div class="question-context">Select all that feel helpful to you.</div>
                    <div class="multi-choice">
                        <div class="multi-choice-item">
                            <input type="checkbox" id="support-listening" name="effective_support" value="deep_listening" />
                            <label for="support-listening">Deep listening</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="checkbox" id="support-practical" name="effective_support" value="practical_solutions" />
                            <label for="support-practical">Practical solutions</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="checkbox" id="support-challenge" name="effective_support" value="gentle_challenges" />
                            <label for="support-challenge">Gentle challenges</label>
                        </div>
                        <div class="multi-choice-item">
                            <input type="checkbox" id="support-presence" name="effective_support" value="just_presence" />
                            <label for="support-presence">Just presence</label>
                        </div>
                    </div>
                </div>
                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousOnboardingStep()">Back</button>
                    <button class="btn btn-primary" onclick="nextOnboardingStep()">Continue</button>
                </div>
            </div>

            <!-- Step 4: Final -->
            <div id="onboarding-step-4" class="onboarding-step" style="display: none;">
                <div class="theme-header">Almost Ready</div>
                <div class="question-section">
                    <label class="question-label">What would you like to call me?</label>
                    <div class="question-context">You can change this anytime.</div>
                    <input type="text" id="ai_name" name="ai_name" value="Cael" />
                </div>
                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousOnboardingStep()">Back</button>
                    <button class="btn btn-primary" onclick="completeOnboarding()">
                        <span>Begin our journey</span>
                        <span class="loading-spinner" style="display: none;"></span>
                    </button>
                </div>
            </div>

            <!-- Completion Step -->
            <div id="onboarding-complete" class="onboarding-step" style="display: none;">
                <div class="completion-animation">
                    <div class="checkmark">‚úì</div>
                </div>
                <h2>All Set! üéâ</h2>
                <p>Your Zentrafuge companion is ready. Let's start our first conversation!</p>
                <button class="btn btn-primary" onclick="enterChat()">Start Chatting</button>
            </div>

            <div class="skip-note">You can skip these questions and customize later in settings.</div>
        </div>
    </div>

    <!-- Chat Screen -->
    <div id="chat-screen" class="screen" style="display: none;">
        <div class="chat-container">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="companion-info">
                    <div class="companion-avatar">
                        <div class="avatar-pulse"></div>
                        <span id="companion-name">Cael</span>
                    </div>
                    <div class="companion-status">
                        <span id="status-text">Online</span>
                        <div id="typing-indicator" class="typing-dots" style="display: none;">
                            <span></span><span></span><span></span>
                        </div>
                    </div>
                </div>
                <div class="chat-actions">
                    <button id="memory-btn" class="action-btn" title="Memory Stats">
                        <span class="icon">üß†</span>
                    </button>
                    <button id="settings-btn" class="action-btn" title="Settings">
                        <span class="icon">‚öôÔ∏è</span>
                    </button>
                    <button id="logout-btn" class="action-btn" title="Logout">
                        <span class="icon">üö™</span>
                    </button>
                </div>
            </div>

            <!-- Chat Messages -->
            <div id="chat-messages" class="chat-messages">
                <div class="welcome-message">
                    <div class="message-bubble system-message">
                        <p>Hello! I'm <span id="welcome-companion-name">Cael</span>, your AI companion. I'm here to listen, learn, and grow with you. What's on your mind today?</p>
                    </div>
                </div>
            </div>

            <!-- Chat Input -->
            <div class="chat-input-container">
                <div id="chat-input-area" class="chat-input-area">
                    <textarea 
                        id="message-input" 
                        placeholder="Type your message here..."
                        rows="1"
                        maxlength="2000"
                    ></textarea>
                    <button id="send-btn" class="send-btn" disabled>
                        <span class="icon">üöÄ</span>
                    </button>
                </div>
                <div class="input-footer">
                    <span id="char-count" class="char-count">0/2000</span>
                    <span class="privacy-note">üîí Encrypted & Private</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Memory Panel (Overlay) -->
    <div id="memory-panel" class="overlay-panel" style="display: none;">
        <div class="panel-content">
            <div class="panel-header">
                <h3>Memory & Growth üß†</h3>
                <button class="close-btn" onclick="closeMemoryPanel()">&times;</button>
            </div>
            <div class="panel-body">
                <div class="memory-stats">
                    <div class="stat-card">
                        <span class="stat-number" id="conversation-count">0</span>
                        <span class="stat-label">Conversations</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="memory-count">0</span>
                        <span class="stat-label">Memories</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="growth-score">0</span>
                        <span class="stat-label">Growth Score</span>
                    </div>
                </div>
                <div class="memory-insights">
                    <h4>Recent Insights</h4>
                    <div id="memory-insights-list">
                        <p class="no-insights">Building memories as we chat...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Panel (Overlay) -->
    <div id="settings-panel" class="overlay-panel" style="display: none;">
        <div class="panel-content">
            <div class="panel-header">
                <h3>Settings ‚öôÔ∏è</h3>
                <button class="close-btn" onclick="closeSettingsPanel()">&times;</button>
            </div>
            <div class="panel-body">
                <div class="settings-section">
                    <h4>Companion Settings</h4>
                    <div class="setting-item">
                        <label for="settings-companion-name">Name</label>
                        <input type="text" id="settings-companion-name" value="Cael">
                    </div>
                    <div class="setting-item">
                        <label for="settings-communication-style">Communication Style</label>
                        <select id="settings-communication-style">
                            <option value="casual">Casual & Friendly</option>
                            <option value="professional">Professional</option>
                            <option value="empathetic">Empathetic</option>
                            <option value="balanced">Balanced</option>
                        </select>
                    </div>
                </div>
                <div class="settings-section">
                    <h4>Privacy & Data</h4>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="data-retention" checked>
                            Allow memory retention for better conversations
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="emotional-analysis" checked>
                            Enable emotional intelligence features
                        </label>
                    </div>
                </div>
                <div class="settings-actions">
                    <button class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
                    <button class="btn btn-secondary" onclick="exportData()">Export My Data</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Toast -->
    <div id="error-toast" class="toast error-toast" style="display: none;">
        <span class="toast-message"></span>
        <button class="toast-close" onclick="hideErrorToast()">&times;</button>
    </div>

    <!-- Success Toast -->
    <div id="success-toast" class="toast success-toast" style="display: none;">
        <span class="toast-message"></span>
        <button class="toast-close" onclick="hideSuccessToast()">&times;</button>
    </div>

    <!-- Scripts -->
    <script src="firebase.js"></script>
    <script src="script.js"></script>
</body>
</html>
